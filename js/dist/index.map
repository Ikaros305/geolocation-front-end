{"version":3,"sources":["disconnected.js","markers.js","map.js","userId.js","socket.js","socketConnectionCheck.js","formhandle.js","success.js","handledisconnect.js","geolocationUpdate.js","index.js"],"names":["module","exports","disconnectedMessage","message","div","document","getElementsByClassName","style","display","classList","remove","add","innerText","setTimeout","markersarray","initMap","center","lat","lng","map","google","maps","Map","getElementById","zoom","db","collection","onSnapshot","changes","snapshot","docChanges","forEach","change","type","marker","InfoWindow","setContent","doc","data","name","open","setPosition","set","id","push","docId","userId","Math","floor","random","socket","io","connect","socketId","spinners","serverDownAlert","getElementsByTagName","body","idtostring2","String","serverDownCheck","on","form","delete","then","socketDisconnect","ConnectionUp","socketid","idtostring","formdiv","addEventListener","e","value","height","preventDefault","alertMessage","contains","handleDisconnect","where","disconnetId","get","docs","setMap","content","showPosition","position","update","coords","latitude","longitude","navigator","geolocation","setInterval","getCurrentPosition","alert","length"],"mappings":"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","file":"index.map","sourceRoot":"..","sourcesContent":["module.exports = {\r\n  disconnectedMessage: function (message) {\r\n    var div = document.getElementsByClassName('success-hide');\r\n    div[0].style.display = \"block\";\r\n    div[0].classList.remove('alert-primary');\r\n    div[0].classList.add('alert-danger');\r\n    div[0].innerText = message;\r\n    setTimeout(function(){ \r\n      div[0].style.display = \"none\";\r\n     }, 8000);\r\n  }\r\n}","module.exports = {\r\n  markersarray: []\r\n}","import { markersarray } from './markers';\r\n\r\nmodule.exports = {\r\n  initMap: function () {\r\n    var center = {\r\n      lat: 51.507351,\r\n      lng: -0.127758\r\n    };\r\n\r\n    // Create a map object and specify the DOM element\r\n    // for display.\r\n    var map = new google.maps.Map(document.getElementById('map'), {\r\n      center: center,\r\n      zoom: 11\r\n    });\r\n    // getting data from database\r\n    db.collection('geolocation').onSnapshot(snapshot => {\r\n      let changes = snapshot.docChanges();\r\n      changes.forEach(change => {\r\n        if (change.type == 'added') {\r\n          // Create a marker and set its position.\r\n          var marker = new google.maps.InfoWindow;\r\n          marker.setContent(change.doc.data().name),\r\n            marker.open(map);\r\n          marker.setPosition({\r\n            lat: change.doc.data().lat,\r\n            lng: change.doc.data().lng\r\n          });\r\n          marker.set('id', change.doc.id);\r\n          markersarray.push(marker);\r\n        } else if (change.type == 'modified') {\r\n          // get modified id of document\r\n          var docId = change.doc.id\r\n          markersarray.forEach(marker => {\r\n            if (marker.id == docId) {\r\n              // update location\r\n              marker.setPosition({\r\n                lat: change.doc.data().lat,\r\n                lng: change.doc.data().lng\r\n              });\r\n            }\r\n          })\r\n        }\r\n      });\r\n    })\r\n  }\r\n}","userId = function () {\r\n    userId = Math.floor((Math.random() * 10000000000000000000) + 1);\r\n    return userId;\r\n}\r\n    module.exports = {\r\n      id: userId()\r\n    }","module.exports = {\r\n  socket: io.connect('http://localhost:4000'),\r\n  socketId: []\r\n}\r\n","import {\r\n  socket\r\n} from './socket';\r\nimport { id } from './userId';\r\nimport socketId from './socket';\r\n\r\nlet spinners = document.getElementsByClassName('main-bg');\r\nlet serverDownAlert = document.getElementsByClassName('serverdownalert');\r\ndocument.getElementsByTagName('form#form');\r\nlet body = document.getElementsByTagName('body');\r\nvar idtostring2 = String(id);\r\n\r\n\r\nmodule.exports = {\r\n  // check if server down\r\n  serverDownCheck: socket.on('connect_error', function () {\r\n    serverDownAlert[0].style.display = 'block';\r\n    body[0].classList.add('spinner-1');\r\n    form.style.display = 'none';\r\n    serverDownAlert[0].innerText = 'Server down please wait while connect again';\r\n    db.collection(\"onlineusers\").doc(socketId.socketId[0]).delete().then(function () {\r\n    })\r\n  }),\r\n\r\n  socketDisconnect: socket.on('disconnect', function(){\r\n    db.collection(\"onlineusers\").doc(socketId.socketId[0]).delete().then(function () {\r\n    })\r\n  }),\r\n\r\n  ConnectionUp: socket.on('connect', function () {\r\n    body[0].classList.remove('spinner-1');\r\n    form.style.display = 'block';\r\n    serverDownAlert[0].style.display = 'none';\r\n    socketId.socketId.push(socket.id);\r\n    db.collection(\"onlineusers\").doc(socket.id).set({\r\n      userId: idtostring2,\r\n      socketid: socket.id\r\n    })\r\n  })\r\n}","import { disconnectedMessage } from './disconnected';\r\nimport { initMap } from './map';\r\nimport { id } from './userId';\r\nimport markersarray from './markers';\r\nimport { socket } from './socket';\r\nimport { serverDownCheck, ConnectionUp } from './socketConnectionCheck';\r\n\r\n\r\nvar idtostring = String(id);\r\n\r\nlet form = document.getElementById('form');\r\nlet formdiv = document.getElementById('main-bg');\r\n\r\nform.addEventListener('submit', (e) => {\r\n  let name = document.getElementById('name').value;\r\n  // remove main main-bg\r\n  formdiv.style.display = \"none\";\r\n  // set map height\r\n  document.getElementById('map').style.height = '100%';\r\n  // save user in database with initizlized lat and lng\r\n  db.collection(\"geolocation\").doc(idtostring).set({\r\n    name: name,\r\n    lat: 51.507351,\r\n    lng: -0.127758,\r\n    userId: idtostring\r\n  })\r\n  // initilize map\r\n  initMap()\r\n  e.preventDefault();\r\n});","module.exports = {\r\n  alertMessage: function (message) {\r\n    var div = document.getElementsByClassName('success-hide');\r\n    if(div[0].classList.contains('alert-danger')) {\r\n      div[0].classList.remove('alert-danger');\r\n      div[0].classList.add('alert-primary');\r\n    }\r\n    div[0].style.display = \"block\";\r\n    div[0].innerText = message;\r\n    setTimeout(function(){ \r\n      div[0].style.display = \"none\";\r\n     }, 8000);\r\n  }\r\n}","import { markersarray } from './markers';\r\nimport { socket } from './socket';\r\nimport { disconnectedMessage } from './disconnected';\r\nmodule.exports = {\r\n  handleDisconnect:\r\n  socket.on('disconnectId', function (data) {\r\n    db.collection('onlineusers').where('socketid', '==', data.disconnetId).get().then((snapshot) => {\r\n      snapshot.docs.forEach(doc => {\r\n        markersarray.forEach(marker => {\r\n          if (marker.id == doc.data().userId) {\r\n            marker.setMap(null);\r\n            disconnectedMessage(marker.content + ' Disconnected');\r\n          }\r\n        });\r\n      });\r\n    });\r\n  })\r\n}","import { id } from './userId';\r\nvar idtostring = String(id);\r\nmodule.exports = {\r\n  showPosition:\r\n   //  update it main functionality\r\n  function showPosition(position) {\r\n    // find user by userId\r\n    db.collection('geolocation').where('userId', '==', idtostring).get().then((snapshot) => {\r\n      snapshot.docs.forEach(doc => {\r\n        const userId = doc.id;\r\n        // update location \r\n        db.collection('geolocation').doc(userId).update({\r\n          lat: position.coords.latitude,\r\n          lng: position.coords.longitude,\r\n        });\r\n      });\r\n    });\r\n  }\r\n}","import formhandle from './formhandle';\r\nimport { alertMessage } from './success';\r\nimport { id } from './userId';\r\nimport socket from './socket';\r\nimport { handledisconnect } from './handledisconnect';\r\nimport { showPosition } from './geolocationUpdate';\r\n\r\n// get position of user every 5 seconds\r\nif (navigator.geolocation) {\r\n  setInterval(function(){\r\n    navigator.geolocation.getCurrentPosition(showPosition);\r\n  }, 5000);\r\n} else {\r\n  alert('Geolocation is not supported by this browser.');\r\n}\r\n\r\n\r\n// functionality for alert messages\r\ndb.collection('geolocation').onSnapshot(snapshot => {\r\n  let changes = snapshot.docChanges();\r\n if (changes.length == 1) {\r\n  changes.forEach(change => {\r\n    if (change.type == 'added') {\r\n      if (change.doc.data().userId == id == false) {\r\n        alertMessage(change.doc.data().name + ' Joined in');\r\n      }\r\n    }\r\n  })\r\n }\r\n})"]}